<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="customer_fragments::head-fragment"></head>

<body>
<div class="site-wrap">
    <div th:replace="customer_fragments::top-fragment"></div>

    <!--/CONTENT HERE/-->
    <div class="site-section">
        <div class="container">
            <div class="row">
                <div class="col-12 title-section mb-5">
                    <h2 class="heading">Info Club</h2>
                </div>

                <div class="container">
                    <div class="d-flex justify-content-center align-items-center" style="background: #18131f; border-radius: 7px; padding: 30px 0px;">
                        <div class="col-lg-5" style="padding: 0 5em;">
                            <img class="img-fluid" th:src="@{${teamDetail.logo_img}}" style="width: 310px; height: 310px;">
                        </div>
                        <div class="col-lg-7">
                            <div class="p-4 rounded" style="font-size: 15rem;">
                                <div class="font-weight-bold">
                                    <p class="team-club-text">Name Club: <span class="team-club-text2" th:text="${teamDetail.name}"></span></p>
                                    <p class="team-club-text">Coach: <span class="team-club-text2" th:text="${teamDetail.coach}"></span></p>
                                    <p class="team-club-text">Home Stadium: <span class="team-club-text2" th:text="${teamDetail.home_stadium}"></span></p>
                                    <p class="team-club-text">Club Valuation: <span class="team-club-text2" th:text="${teamDetail.club_valuation} + 'B (â‚¬)'"></span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="site-section">
        <div class="container">
            <div class="row">
                <div class="col-12 title-section">
                    <h2 class="heading">Recent Matches</h2>
                </div>
                <div class="col-lg-6 mb-4" th:each="recentMatchesbyTeam : ${recentMatches}">
                    <div class="bg-light p-4 rounded" style="height: 100%">
                        <div>
                            <div class="widget-vs">
                                <div class="d-flex align-items-center justify-content-around justify-content-between w-100">
                                    <div class="team-1 text-center" style="width: 160px">
                                        <img th:src="@{${recentMatchesbyTeam.home_team.logo_img}}" alt="Image"
                                             style="height: 110px; width: 110px">
                                        <h3 class="mt-3" th:text="${recentMatchesbyTeam.home_team.name}"
                                            style="height: 40px;"></h3>
                                    </div>
                                    <div class="mr-4 ml-4">
                                    <span class="vs">
                                        <span style="font-size: 35px; border-radius: 12px; padding: 0 10px;" th:class="'match-over-score-' + ${recentMatchesbyTeam.id}"></span>
                                    </span>
                                    </div>
                                    <div class="team-2 text-center" style="width: 160px">
                                        <img th:src="@{${recentMatchesbyTeam.away_team.logo_img}}" alt="Image"
                                             style="height: 110px; width: 110px">
                                        <h3 class="mt-3" th:text="${recentMatchesbyTeam.away_team.name}"
                                            style="height: 40px;"></h3>
                                    </div>
                                </div>
                                <div class="d-flex align-items-center justify-content-around justify-content-between w-100">
                                    <div class="team-1 text-center mt-2" style="width: 160px">
                                        <div th:class="'mt-2 home-match-team-event-' + ${recentMatchesbyTeam.id}">
                                        </div>
                                    </div>
                                    <div class="mr-5 ml-5"></div>
                                    <div class="team-2 text-center mt-2" style="width: 160px">
                                        <div th:class="'away-match-team-event-' + ${recentMatchesbyTeam.id}">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="container" style="margin-bottom: 150px">
            <div class="row">
                <div class="container" th:if="${players != null and #lists.size(players) > 0}">
                    <div>
                        <div class="row">
                            <div class="col-md-12">
                                <h2 class="player-title">GOALKEEPERS</h2>
                            </div>
                        </div>
                        <hr style="border-top: 1px solid #666666; margin-bottom: 0">
                        <div class="row">
                            <div style="padding: 10px" class="col-md-3 player-team" th:each="player : ${players}" th:if="${player.position == 'Goalkeepers'}">
                                <a href="">
                                    <img th:src="@{${player.avatar_img}}" alt="Image 1" class="img-fluid player-img">
                                    <div class="player-info">
                                        <p class="position-absolute player-text player-number" th:text="${player.number}"></p>
                                        <p class="position-absolute player-text player-name" th:text="${player.name}"></p>
                                    </div>
                                </a>
                            </div>
                        </div>

                        <div class="row mt-5">
                            <div class="col-md-12">
                                <h2 class="player-title">DEFENDERS</h2>
                            </div>
                        </div>
                        <hr style="border-top: 1px solid #666666;">
                        <div class="row">
                            <div style="padding: 10px" class="col-md-3 player-team" th:each="player : ${players}" th:if="${player.position == 'Defenders'}">
                                <a href="">
                                    <img th:src="@{${player.avatar_img}}" alt="Image 1" class="img-fluid player-img">
                                    <div class="player-info">
                                        <p class="position-absolute player-text player-number" th:text="${player.number}"></p>
                                        <p class="position-absolute player-text player-name" th:text="${player.name}"></p>
                                    </div>
                                </a>
                            </div>
                        </div>

                        <div class="row mt-5">
                            <div class="col-md-12">
                                <h2 class="player-title">QUARTERBACKS</h2>
                            </div>
                        </div>
                        <hr style="border-top: 1px solid #666666;">
                        <div class="row">
                            <div style="padding: 10px" class="col-md-3 player-team" th:each="player : ${players}" th:if="${player.position == 'Quarterbacks'}">
                                <a href="">
                                    <img th:src="@{${player.avatar_img}}" alt="Image 1" class="img-fluid player-img">
                                    <div class="player-info">
                                        <p class="position-absolute player-text player-number" th:text="${player.number}"></p>
                                        <p class="position-absolute player-text player-name" th:text="${player.name}"></p>
                                    </div>
                                </a>
                            </div>
                        </div>

                        <div class="row mt-5">
                            <div class="col-md-12">
                                <h2 class="player-title">STRIKERS</h2>
                            </div>
                        </div>
                        <hr style="border-top: 1px solid #666666;">
                        <div class="row">
                            <div style="padding: 10px" class="col-md-3 player-team" th:each="player : ${players}" th:if="${player.position == 'Strikers'}">
                                <a href="">
                                    <img th:src="@{${player.avatar_img}}" alt="Image 1" class="img-fluid player-img">
                                    <div class="player-info">
                                        <p class="position-absolute player-text player-number" th:text="${player.number}"></p>
                                        <p class="position-absolute player-text player-name" th:text="${player.name}"></p>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    <!--/END CONTENT HERE/-->

    <div th:replace="customer_fragments::bot-fragment"></div>
</div>

<div th:replace="customer_fragments::script-fragment"></div>

<script th:if="${recentMatches} and ${#lists.size(recentMatches) > 0}" th:each="match : ${recentMatches}">
    var matchId = [[${match.id}]];
    var homeTeamId = [[${match.home_team_id.id}]];
    var awayTeamId = [[${match.away_team_id.id}]];

    var dataToSend = {
        homeTeamId: homeTeamId,
        awayTeamId: awayTeamId,
        matchId: matchId
    };

    if (!dataToSend.matchId.isEmpty) {
        $.ajax({
            type: 'POST',
            url: '/api/getTeamEvent',
            contentType: 'application/json',
            data: JSON.stringify(dataToSend),
            success: function (res) {
                var homeTeamEventsUl = $('.home-match-team-event-' + res.matchId);
                homeTeamEventsUl.empty();
                $.each(res.homeTeamEventGoal, function (index, event) {
                    getPlayerById(event.player_id, function (player) {
                        var timeParts = event.time.split(':');
                        var minutes = timeParts[0];
                        var li = $('<li>').html('<p>' + player.name + ' (' + minutes + '\')</p>');
                        homeTeamEventsUl.append(li);
                    });
                });

                var awayTeamEventsUl = $('.away-match-team-event-' + res.matchId);
                awayTeamEventsUl.empty();
                $.each(res.awayTeamEventGoal, function (index, event) {
                    getPlayerById(event.player_id, function (player) {
                        var timeParts = event.time.split(':');
                        var minutes = timeParts[0];
                        var li = $('<li>').html('<p>' + player.name + ' (' + minutes + '\')</p>');
                        awayTeamEventsUl.append(li);
                    });
                });

                $('.match-over-score-' + res.matchId).html(res.homeTeamScore + ' - ' + res.awayTeamScore);
            }
        });

    }

    function getPlayerById(id, callback) {
        $.ajax({
            type: 'POST',
            url: '/api/getPlayerById',
            contentType: 'application/json',
            data: JSON.stringify({id: id}),
            success: function (res) {
                callback(res);
            }
        });
    }
</script>
</body>

</html>