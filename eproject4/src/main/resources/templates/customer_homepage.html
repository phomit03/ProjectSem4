<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="customer_fragments::head-fragment"></head>

<body>
<div class="site-wrap">
    <div th:fragment="top-fragment">
        <div class="site-mobile-menu site-navbar-target">
            <div class="site-mobile-menu-header">
                <div class="site-mobile-menu-close">
                    <span class="icon-close2 js-menu-toggle"></span>
                </div>
            </div>
            <div class="site-mobile-menu-body"></div>
        </div>

        <header class="site-navbar py-4" role="banner">
            <div class="container">
                <div class="d-flex align-items-center">
                    <div class="site-logo">
                        <a th:href="@{/home}">
                            <img th:src="@{/user/images/logo.png}" alt="Logo">
                        </a>
                    </div>
                    <div class="ml-auto">
                        <nav class="site-navigation position-relative text-right" role="navigation">
                            <ul class="site-menu main-menu js-clone-nav mr-auto d-none d-lg-block">
                                <li th:classappend="${#httpServletRequest.getRequestURI().startsWith('/home') ? 'active' : ''}">
                                    <a th:href="@{/home}" class="nav-link">Home</a>
                                </li>
                                <li th:classappend="${#httpServletRequest.getRequestURI().startsWith('/matches') ? 'active' : ''}">
                                    <a th:href="@{/matches}" class="nav-link">Matches</a>
                                </li>
                                <li th:classappend="${#httpServletRequest.getRequestURI().startsWith('/teams') ? 'active' : ''}">
                                    <a th:href="@{/teams}" class="nav-link">Teams</a>
                                </li>
                                <li th:classappend="${#httpServletRequest.getRequestURI().startsWith('/news') ? 'active' : ''}">
                                    <a th:href="@{/news}" class="nav-link">News</a>
                                </li>
                                <li th:classappend="${#httpServletRequest.getRequestURI().startsWith('/feedback') ? 'active' : ''}">
                                    <a th:href="@{/feedback}" class="nav-link">Feedback</a>
                                </li>
                                <li th:classappend="${#httpServletRequest.getRequestURI().startsWith('/list_tickets') ? 'active' : ''}">
                                    <a th:href="@{/list_tickets}" class="nav-link">Book Tickets</a>
                                </li>

                                <!--login/user-->
                                <li th:if="${session.loggedInUser == null }">
                                    <a th:href="@{/login}" class="btn-primary py-2 px-3">Login
                                        <i class="icon-user"
                                           aria-hidden="true">
                                        </i>
                                    </a>
                                </li>
                                <li th:if="${session.loggedInUser != null}">
                                    <div class="nav-item dropdown">
                                        <a href="#" class="nav-link dropdown-toggle" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <img class="rounded-circle me-lg-2"
                                                 th:src="@{/admin_static/img/user.jpg}"
                                                 alt="" style="width: 40px; height: 40px;">
                                            <span class="ml-1 d-lg-inline-flex text-white"
                                                  th:if="${session.loggedInUser != null}"
                                                  th:text="${session.loggedInUser.fullName}"></span>
                                            <i class="bi bi-caret-down color-red icon-large"></i>
                                        </a>
                                        <div class="dropdown-menu" aria-labelledby="userDropdown">
                                            <a class="dropdown-item dropdown-fix color-grey"
                                               th:href="@{/account/info/{id} (id=${session.loggedInUser.id})}">
                                                <i class="icon-user mr-2 color-red"></i> Info Account
                                            </a>
                                            <a class="dropdown-item dropdown-fix color-grey" href="#">
                                                <i class="icon-ticket mr-2 color-red"></i> My ticket
                                            </a>
                                            <div class="dropdown-divider"></div>
                                            <a class="dropdown-item dropdown-fix2 color-red" th:href="@{/logout}">
                                                <i class="icon-arrow-right mr-2 color-red"></i> Logout
                                            </a>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <a th:href="@{/shopping_cart}" style="font-size: large">
                                        <i class="icon-shopping-cart" aria-hidden="true"></i>
                                    </a>
                                </li>
                            </ul>
                        </nav>

                        <a href="#"
                           class="d-inline-block d-lg-none site-menu-toggle js-menu-toggle text-black float-right text-white"><span
                                class="icon-menu h3 text-white"></span></a>
                    </div>
                </div>
            </div>
        </header>

        <div class="hero overlay" style="background-image: url('/user/images/bg_3.jpg');">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-5 ml-auto">
                        <h1 class="text-white" th:text="${overlay_title}"></h1>
                        <p th:text="${description}"></p>
                        <div id="date-countdown"></div>
                        <p>
                            <a href="#" class="btn btn-primary py-3 px-4 mr-3">Set Reminders</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--/CONTENT HERE/-->
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div th:if="${nextMatchesOrLiveMatches} and ${#lists.size(nextMatchesOrLiveMatches) > 0}" class="d-flex team-vs">
                    <span class="score live-score"></span>
                    <div class="team-1 w-50">
                        <div class="team-details w-100 text-center">
                            <input type="hidden" class="live-match-id" th:value="${nextMatchesOrLiveMatches[0].id}">
                            <img th:src="@{${nextMatchesOrLiveMatches[0].home_team.logo_img}}" alt="Image" class="img-fluid" style="width: 70px; height: 75px">
                            <h3 class="mt-2" th:text="${nextMatchesOrLiveMatches[0].home_team.name}"></h3>
                            <input type="hidden" class="home-team-id" th:value="${nextMatchesOrLiveMatches[0].home_team.id}">
                            <ul class="list-unstyled home-team-event">

                            </ul>
                        </div>
                    </div>
                    <div class="team-2 w-50">
                        <div class="team-details w-100 text-center">
                            <img th:src="@{${nextMatchesOrLiveMatches[0].away_team.logo_img}}" alt="Image" class="img-fluid" style="width: 70px; height: 75px">
                            <h3 class="mt-2" th:text="${nextMatchesOrLiveMatches[0].away_team.name}"></h3>
                            <input type="hidden" class="away-team-id" th:value="${nextMatchesOrLiveMatches[0].away_team.id}">
                            <ul class="list-unstyled away-team-event">

                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="latest-news">
        <div class="container">
            <div class="row">
                <div class="col-12 title-section">
                    <h2 class="heading">Latest News</h2>
                </div>
            </div>
            <div class="row no-gutters">
                <div class="col-md-4">
                    <div class="post-entry" routerLink="/news/detail">
                            <img th:src="@{/user/images/img_1.jpg}" alt="Image" class="img-fluid">
                        <div class="caption">
                            <div class="caption-inner">
                                <a th:href="@{/news/detail}" routerLink="/news/detail">
                                    <h3 class="mb-3">Romolu to stay at Real Nadrid?</h3>
                                </a>
                                <div class="author d-flex align-items-center">
                                    <div class="img mb-2 mr-3">
                                        <a routerLink="/news/detail">
                                            <img th:src="@{/user/images/fabio_romaro.jpg}" alt="" style="width: 40px; height: 40px">
                                        </a>
                                    </div>
                                    <div class="text">
                                        <h4>Fabrizio Romano</h4>
                                        <span>May 19, 2020 &bullet; Sports</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div th:href="@{/news/detail}" class="post-entry" routerLink="/news/detail">
                        <a>
                            <img th:src="@{/user/images/img_3.jpg}" alt="Image" class="img-fluid">
                        </a>
                        <div class="caption">
                            <div class="caption-inner">
                                <a th:href="@{/news/detail}" routerLink="/news/detail">
                                    <h3 class="mb-3">Kai Nets Double To Secure Comfortable Away Win</h3>
                                </a>
                                <div class="author d-flex align-items-center">
                                    <div class="img mb-2 mr-3">
                                        <a routerLink="/news/detail">
                                            <img th:src="@{/user/images/david_ornstein.jpg}" alt="">
                                        </a>
                                    </div>
                                    <div class="text">
                                        <h4>David Ornstein</h4>
                                        <span>May 19, 2020 &bullet; Sports</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="post-entry" routerLink="/news/detail">
                        <a>
                            <img th:src="@{/user/images/img_2.jpg}" alt="Image" class="img-fluid">
                        </a>
                        <div class="caption">
                            <div class="caption-inner">
                                <a th:href="@{/news/detail}" routerLink="/news/detail">
                                    <h3 class="mb-3">Dogba set for Juvendu return?</h3>
                                </a>
                                <div class="author d-flex align-items-center">
                                    <div class="img mb-2 mr-3">
                                        <a routerLink="/news/detail">
                                            <img th:src="@{/user/images/anh_ngoc.jpg}" alt="">
                                        </a>
                                    </div>
                                    <div class="text">
                                        <h4>Trương Anh Ngọc</h4>
                                        <span>May 19, 2020 &bullet; Sports</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div class="site-section bg-dark">
        <div class="container">
            <div class="row">
                <div class="col-lg-6">
                    <div class="widget-next-match">
                        <div class="widget-title">
                            <h3>Next Match</h3>
                        </div>
                        <div class="widget-body mb-3">
                            <div class="widget-vs">
                                <div class="d-flex align-items-center justify-content-around justify-content-between w-100">
                                    <div class="team-1 text-center">
                                        <img th:src="@{/user/images/logo_1.png}" alt="Image">
                                        <h3>Football League</h3>
                                    </div>
                                    <div>
                                        <span class="vs"><span>VS</span></span>
                                    </div>
                                    <div class="team-2 text-center">
                                        <img th:src="@{/user/images/logo_2.png}" alt="Image">
                                        <h3>Soccer</h3>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="text-center widget-vs-contents mb-4">
                            <h4>World Cup League</h4>
                            <p class="mb-5">
                                <span class="d-block">December 20th, 2020</span>
                                <span class="d-block">9:30 AM GMT+0</span>
                                <strong class="text-primary">New Euro Arena</strong>
                            </p>

                            <div id="date-countdown2" class="pb-1"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">

                    <div class="widget-next-match">
                        <table class="table custom-table">
                            <thead>
                            <tr>
                                <th>P</th>
                                <th>Team</th>
                                <th>W</th>
                                <th>D</th>
                                <th>L</th>
                                <th>PTS</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>1</td>
                                <td><a th:href="@{/teams/detail}" class="text-white" routerLink="/teams/detail"><u>Football League</u></a></td>
                                <td>22</td>
                                <td>3</td>
                                <td>2</td>
                                <td>140</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td><a th:href="@{/teams/detail}" class="text-white" routerLink="/teams/detail"><u>Soccer League</u></a></td>
                                <td>22</td>
                                <td>3</td>
                                <td>2</td>
                                <td>140</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td><a th:href="@{/teams/detail}" class="text-white" routerLink="/teams/detail"><u>Juvendo</u></a></td>
                                <td>22</td>
                                <td>3</td>
                                <td>2</td>
                                <td>140</td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td><a th:href="@{/teams/detail}" class="text-white" routerLink="/teams/detail"><u>French Football League</u></a></td>
                                <td>22</td>
                                <td>3</td>
                                <td>2</td>
                                <td>140</td>
                            </tr>
                            <tr>
                                <td>5</td>
                                <td><a th:href="@{/teams/detail}" class="text-white" routerLink="/teams/detail"><u>Football League</u></a></td>
                                <td>22</td>
                                <td>3</td>
                                <td>2</td>
                                <td>140</td>
                            </tr>
                            <tr>
                                <td>6</td>
                                <td><a th:href="@{/teams/detail}" class="text-white" routerLink="/teams/detail"><u>Football League</u></a></td>
                                <td>22</td>
                                <td>3</td>
                                <td>2</td>
                                <td>140</td>
                            </tr>
                            <tr>
                                <td>7</td>
                                <td><a th:href="@{/teams/detail}" class="text-white" routerLink="/teams/detail"><u>Football League</u></a></td>
                                <td>22</td>
                                <td>3</td>
                                <td>2</td>
                                <td>140</td>
                            </tr>
                            <tr>
                                <td>8</td>
                                <td><a th:href="@{/teams/detail}" class="text-white" routerLink="/teams/detail"><u>Football League</u></a></td>
                                <td>22</td>
                                <td>3</td>
                                <td>2</td>
                                <td>140</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
        </div>
    </div> <!-- .site-section -->

    <div class="site-section">
        <div class="container">
            <div class="row">
                <div class="col-6 title-section">
                    <h2 class="heading">Videos</h2>
                </div>
                <div class="col-6 text-right">
                    <div class="custom-nav">
                        <a href="#" class="js-custom-prev-v2"><span class="icon-keyboard_arrow_left"></span></a>
                        <span></span>
                        <a href="#" class="js-custom-next-v2"><span class="icon-keyboard_arrow_right"></span></a>
                    </div>
                </div>
            </div>


            <div class="owl-4-slider owl-carousel">
                <div class="item">
                    <div class="video-media">
                        <img th:src="@{/user/images/img_1.jpg}" alt="Image" class="img-fluid">
                        <a href="https://vimeo.com/139714818" class="d-flex play-button align-items-center" data-fancybox>
            <span class="icon mr-3">
              <span class="icon-play"></span>
            </span>
                            <div class="caption">
                                <h3 class="m-0">Pogba set for Juventus return?</h3>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="item">
                    <div class="video-media">
                        <img th:src="@{/user/images/img_2.jpg}" alt="Image" class="img-fluid">
                        <a href="https://vimeo.com/139714818" class="d-flex play-button align-items-center" data-fancybox>
            <span class="icon mr-3">
              <span class="icon-play"></span>
            </span>
                            <div class="caption">
                                <h3 class="m-0">Kai Nets Double To Secure Comfortable Away Win</h3>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="item">
                    <div class="video-media">
                        <img th:src="@{/user/images/img_3.jpg}" alt="Image" class="img-fluid">
                        <a href="https://vimeo.com/139714818" class="d-flex play-button align-items-center" data-fancybox>
            <span class="icon mr-3">
              <span class="icon-play"></span>
            </span>
                            <div class="caption">
                                <h3 class="m-0">Ronado to stay at Real Madrid?</h3>
                            </div>
                        </a>
                    </div>
                </div>

                <div class="item">
                    <div class="video-media">
                        <img th:src="@{/user/images/img_1.jpg}" alt="Image" class="img-fluid">
                        <a href="https://vimeo.com/139714818" class="d-flex play-button align-items-center" data-fancybox>
            <span class="icon mr-3">
              <span class="icon-play"></span>
            </span>
                            <div class="caption">
                                <h3 class="m-0">Pogba set for Juventus return?</h3>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="item">
                    <div class="video-media">
                        <img th:src="@{/user/images/img_2.jpg}" alt="Image" class="img-fluid">
                        <a href="https://vimeo.com/139714818" class="d-flex play-button align-items-center" data-fancybox>
            <span class="icon mr-3">
              <span class="icon-play"></span>
            </span>
                            <div class="caption">
                                <h3 class="m-0">Kai Nets Double To Secure Comfortable Away Win</h3>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="item">
                    <div class="video-media">
                        <img th:src="@{/user/images/img_3.jpg}" alt="Image" class="img-fluid">
                        <a href="https://vimeo.com/139714818" class="d-flex play-button align-items-center" data-fancybox>
            <span class="icon mr-3">
              <span class="icon-play"></span>
            </span>
                            <div class="caption">
                                <h3 class="m-0">Ronado to stay at Real Madrid?</h3>
                            </div>
                        </a>
                    </div>
                </div>

            </div>

        </div>
    </div>

    <div class="container site-section">
        <div class="row">
            <div class="col-6 title-section">
                <h2 class="heading">Our Blog</h2>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-6">
                <div class="custom-media d-flex">
                    <div class="img mr-4">
                        <a th:href="@{/news/detail}">
                            <img th:src="@{/user/images/img_1.jpg}" alt="Image" class="img-fluid">
                        </a>
                    </div>
                    <div class="text">
                        <span class="meta">May 20, 2020</span>
                        <h3 class="mb-4"><a th:href="@{/news/detail}">Romolu to stay at Real Nadrid?</a></h3>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Possimus deserunt saepe tempora dolorem.</p>
                        <p><a href="#">Read more</a></p>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="custom-media d-flex">
                    <div class="img mr-4">
                        <a th:href="@{/news/detail}">
                            <img th:src="@{/user/images/img_3.jpg}" alt="Image" class="img-fluid">
                        </a>
                    </div>
                    <div class="text">
                        <span class="meta">May 20, 2020</span>
                        <h3 class="mb-4"><a th:href="@{/news/detail}">Romolu to stay at Real Nadrid?</a></h3>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Possimus deserunt saepe tempora dolorem.</p>
                        <p><a href="#">Read more</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--/END CONTENT HERE/-->

    <div th:replace="customer_fragments::bot-fragment"></div>
</div>

<div th:replace="customer_fragments::script-fragment"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.0/sockjs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>

<script>
    $(document).ready(function () {
        var socket = new SockJS('/ws-endpoint');
        var stompClient = Stomp.over(socket);

        stompClient.connect({}, function (frame) {
            stompClient.subscribe('/topic/score', function (scoreUpdate) {
                var scoreUpdateObj = JSON.parse(scoreUpdate.body);

                updateScoreOnPage(scoreUpdateObj.homeTeamScore, scoreUpdateObj.awayTeamScore);

                var homeTeamEventsUl = $('.home-team-event');
                homeTeamEventsUl.empty();
                $.each(scoreUpdateObj.homeTeamEventGoal, function (index, event) {
                    getPlayerById(event.player_id, function(player) {
                        var li = $('<li>').text(player.name + ' (' + event.time + ')');
                        homeTeamEventsUl.append(li);
                    });
                });

                var awayTeamEventsUl = $('.away-team-event');
                awayTeamEventsUl.empty();
                $.each(scoreUpdateObj.awayTeamEventGoal, function (index, event) {
                    getPlayerById(event.player_id, function(player) {
                        var li = $('<li>').text(player.name + ' (' + event.time + ')');
                        awayTeamEventsUl.append(li);
                    });
                });
            });
        });
    });

    function updateScoreOnPage(homeScore, awayScore) {
        $('.live-score').html(homeScore + '-' + awayScore);
    }

    function getPlayerById(id, callback) {
        $.ajax({
            type: 'POST',
            url: '/api/getPlayerById',
            contentType: 'application/json',
            data: JSON.stringify({ id: id }),
            success: function (res) {
                callback(res);
            }
        });
    }
</script>

<script>
    var dataToSend = {
        homeTeamId: $('.home-team-id').val(),
        awayTeamId: $('.away-team-id').val(),
        matchId: $('.live-match-id').val()
    };

    if (!dataToSend.matchId.isEmpty) {
        $.ajax({
            type: 'POST',
            url: '/api/getTeamEvent',
            contentType: 'application/json',
            data: JSON.stringify(dataToSend),
            success: function (res) {
                var homeTeamEventsUl = $('.home-team-event');
                homeTeamEventsUl.empty();
                $.each(res.homeTeamEventGoal, function (index, event) {
                    getPlayerById(event.player_id, function(player) {
                        var li = $('<li>').text(player.name + ' (' + event.time + ')');
                        homeTeamEventsUl.append(li);
                    });
                });

                var awayTeamEventsUl = $('.away-team-event');
                awayTeamEventsUl.empty();
                $.each(res.awayTeamEventGoal, function (index, event) {
                    getPlayerById(event.player_id, function(player) {
                        var li = $('<li>').text(player.name + ' (' + event.time + ')');
                        awayTeamEventsUl.append(li);
                    });
                });

                $('.live-score').html(res.homeTeamScore + '-' + res.awayTeamScore);
            }
        });
    }
    function getPlayerById(id, callback) {
        $.ajax({
            type: 'POST',
            url: '/api/getPlayerById',
            contentType: 'application/json',
            data: JSON.stringify({ id: id }),
            success: function (res) {
                callback(res);
            }
        });
    }
</script>

<!-- Bao gồm Bootstrap JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.2/js/bootstrap.bundle.min.js"></script>


</body>

</html>